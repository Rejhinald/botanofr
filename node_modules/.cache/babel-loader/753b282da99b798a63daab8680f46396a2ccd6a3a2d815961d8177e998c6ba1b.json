{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Arwin Miclat/Desktop/Botano/Botano/botano/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Arwin Miclat/Desktop/Botano/Botano/botano/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Arwin Miclat/Desktop/Botano/Botano/botano/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{Table,Button,Form,Row,Col}from\"react-bootstrap\";import{LinkContainer}from\"react-router-bootstrap\";import{Link,useNavigate}from\"react-router-dom\";import Loader from\"../components/Loader\";import Message from\"../components/Message\";import{useDispatch,useSelector}from\"react-redux\";import{listUsers}from\"../actions/accountActions\";import axios from\"axios\";import CancelSubscriptionAdmin from\"../components/CancelSubscriptionAdmin\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UserListScreen=function UserListScreen(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),accessToken=_useState2[0],setAccessToken=_useState2[1];useEffect(function(){var clientId=\"AUgpEmZhBp5JIEIFTUcY2fCqZGncGEduE2tq8suRS39oXl768r0V30K8JwyfmFvjSLGr8kMFSZTJQ2R5\";var clientSecret=\"EHy-pakVBl3geNd_BbPwTgyBURTPlWZLPj1Hki65JhgTpuuLV-mSuKlyGMVkuCn5E-WbOLc_coY1RXrb\";// dispatch(getUserDetails(\"profile\"));\nif(!accessToken){var getToken=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios({method:\"post\",url:\"https://api.sandbox.paypal.com/v1/oauth2/token\",headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",Authorization:\"Basic \".concat(btoa(\"\".concat(clientId,\":\").concat(clientSecret)))},data:\"grant_type=client_credentials\"});case 3:response=_context.sent;console.log(response.data);setAccessToken(response.data.access_token);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 11:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return function getToken(){return _ref.apply(this,arguments);};}();getToken();var intervalId=setInterval(function(){getToken();},60000);return function(){return clearInterval(intervalId);};}},[accessToken]);var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),search=_useState4[0],setSearch=_useState4[1];var dispatch=useDispatch();useEffect(function(){dispatch(listUsers());},[]);var userList=useSelector(function(state){return state.userList;});var error=userList.error,loading=userList.loading,users=userList.users;var userLogin=useSelector(function(state){return state.userLogin;});var navigate=useNavigate();var userInfo=userLogin.userInfo;if(!userInfo){navigate(\"/login\");}else{if(!userInfo.isAdmin){navigate(\"/\");}}return/*#__PURE__*/_jsxs(\"div\",{style:{margin:\"2% 15%\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h3\",{children:\"User List\"}),/*#__PURE__*/_jsx(Form,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:3}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsx(Form.Control,{onChange:function onChange(e){return setSearch(e.target.value);},type:\"search\",placeholder:\"Search\",className:\"me-1\",\"aria-label\":\"Search\"})})]})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Link,{to:\"/register\",className:\"btn btn-secondary\",children:\"Add User\"})})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"First Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Last Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Subscription Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Subscription ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),loading?/*#__PURE__*/_jsx(Loader,{}):error?/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error}):/*#__PURE__*/_jsx(\"tbody\",{children:users.filter(function(user){return search===\"\"||user.email.toLowerCase().includes(search.toLowerCase())||user.first_name.toLowerCase().includes(search.toLowerCase())||user.last_name.toLowerCase().includes(search.toLowerCase())||user.subscription_id.toLowerCase().includes(search.toLowerCase())||user.isSubscriber&&search.toLowerCase()===\"active\"||!user.isSubscriber&&search.toLowerCase()===\"inactive\"||user.plan_id.toLowerCase().includes(search.toLowerCase());}).map(function(users){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:users.first_name}),/*#__PURE__*/_jsx(\"td\",{children:users.last_name}),/*#__PURE__*/_jsx(\"td\",{children:users.email}),/*#__PURE__*/_jsx(\"td\",{children:users.isSubscriber?\"Active\":\"Inactive\"}),/*#__PURE__*/_jsx(\"td\",{children:users.subscription_id}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"div\",{class:\"d-flex justify-content-center align-items-center\",children:/*#__PURE__*/_jsx(\"div\",{class:\"d-grid gap-1\",children:/*#__PURE__*/_jsx(CancelSubscriptionAdmin,{subscriptionId:users.subscription_id,accessToken:accessToken,id:users._id})})})})]},users._id);})})]})]});};export default UserListScreen;","map":{"version":3,"names":["React","useEffect","useState","Table","Button","Form","Row","Col","LinkContainer","Link","useNavigate","Loader","Message","useDispatch","useSelector","listUsers","axios","CancelSubscriptionAdmin","UserListScreen","accessToken","setAccessToken","clientId","clientSecret","getToken","method","url","headers","Authorization","btoa","data","response","console","log","access_token","error","intervalId","setInterval","clearInterval","search","setSearch","dispatch","userList","state","loading","users","userLogin","navigate","userInfo","isAdmin","margin","e","target","value","filter","user","email","toLowerCase","includes","first_name","last_name","subscription_id","isSubscriber","plan_id","map","_id"],"sources":["C:/Users/Arwin Miclat/Desktop/Botano/Botano/botano/src/screens/UserListScreen.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Table, Button, Form, Row, Col } from \"react-bootstrap\";\r\nimport { LinkContainer } from \"react-router-bootstrap\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport Loader from \"../components/Loader\";\r\nimport Message from \"../components/Message\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { listUsers } from \"../actions/accountActions\";\r\nimport axios from \"axios\";\r\nimport CancelSubscriptionAdmin from \"../components/CancelSubscriptionAdmin\";\r\n\r\nconst UserListScreen = () => {\r\n  const [accessToken, setAccessToken] = useState(\"\");\r\n  useEffect(() => {\r\n    const clientId =\r\n      \"AUgpEmZhBp5JIEIFTUcY2fCqZGncGEduE2tq8suRS39oXl768r0V30K8JwyfmFvjSLGr8kMFSZTJQ2R5\";\r\n    const clientSecret =\r\n      \"EHy-pakVBl3geNd_BbPwTgyBURTPlWZLPj1Hki65JhgTpuuLV-mSuKlyGMVkuCn5E-WbOLc_coY1RXrb\";\r\n    // dispatch(getUserDetails(\"profile\"));\r\n    if (!accessToken) {\r\n      const getToken = async () => {\r\n        try {\r\n          const response = await axios({\r\n            method: \"post\",\r\n            url: \"https://api.sandbox.paypal.com/v1/oauth2/token\",\r\n            headers: {\r\n              \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n              Authorization: `Basic ${btoa(`${clientId}:${clientSecret}`)}`,\r\n            },\r\n            data: \"grant_type=client_credentials\",\r\n          });\r\n\r\n          console.log(response.data);\r\n          setAccessToken(response.data.access_token);\r\n        } catch (error) {\r\n          console.error(error);\r\n        }\r\n      };\r\n\r\n      getToken();\r\n\r\n      const intervalId = setInterval(() => {\r\n        getToken();\r\n      }, 60000);\r\n\r\n      return () => clearInterval(intervalId);\r\n    }\r\n  }, [accessToken]);\r\n\r\n  const [search, setSearch] = useState(\"\");\r\n  const dispatch = useDispatch();\r\n  useEffect(() => {\r\n    dispatch(listUsers());\r\n  }, []);\r\n  const userList = useSelector((state) => state.userList);\r\n  const { error, loading, users } = userList;\r\n  const userLogin = useSelector((state) => state.userLogin);\r\n  let navigate = useNavigate();\r\n  const { userInfo } = userLogin;\r\n\r\n  if (!userInfo) {\r\n    navigate(\"/login\");\r\n  } else {\r\n    if (!userInfo.isAdmin) {\r\n      navigate(\"/\");\r\n    }\r\n  }\r\n  return (\r\n    <div style={{ margin: \"2% 15%\" }}>\r\n      <div className=\"text-center\">\r\n        <br />\r\n        <h3>User List</h3>\r\n        <Form>\r\n          <Row>\r\n            <Col md={3} />\r\n            <Col md={6}>\r\n              <Form.Control\r\n                onChange={(e) => setSearch(e.target.value)}\r\n                type=\"search\"\r\n                placeholder=\"Search\"\r\n                className=\"me-1\"\r\n                aria-label=\"Search\"\r\n              />\r\n            </Col>\r\n          </Row>\r\n        </Form>\r\n        <br />\r\n            <div>\r\n              <Link to=\"/register\" className=\"btn btn-secondary\">\r\n                Add User\r\n              </Link>\r\n        </div>\r\n      </div>\r\n      <br />\r\n      <Table striped bordered hover>\r\n        <thead>\r\n          <tr>\r\n            <th>First Name</th>\r\n            <th>Last Name</th>\r\n            <th>Email</th>\r\n            <th>Subscription Status</th>\r\n            <th>Subscription ID</th>\r\n            <th>Actions</th>\r\n          </tr>\r\n        </thead>\r\n        {loading ? (\r\n          <Loader />\r\n        ) : error ? (\r\n          <Message variant=\"danger\">{error}</Message>\r\n        ) : (\r\n          <tbody>\r\n            {users\r\n              .filter((user) => {\r\n                return (\r\n                  search === \"\" ||\r\n                  user.email.toLowerCase().includes(search.toLowerCase()) ||\r\n                  user.first_name\r\n                    .toLowerCase()\r\n                    .includes(search.toLowerCase()) ||\r\n                  user.last_name.toLowerCase().includes(search.toLowerCase()) ||\r\n                  user.subscription_id\r\n                    .toLowerCase()\r\n                    .includes(search.toLowerCase()) ||\r\n                  (user.isSubscriber && search.toLowerCase() === \"active\") ||\r\n                  (!user.isSubscriber && search.toLowerCase() === \"inactive\") ||\r\n                  user.plan_id.toLowerCase().includes(search.toLowerCase())\r\n                );\r\n              })\r\n              .map((users) => {\r\n                return (\r\n                  <tr key={users._id}>\r\n                    <td>{users.first_name}</td>\r\n\r\n                    <td>{users.last_name}</td>\r\n                    <td>{users.email}</td>\r\n                    <td>{users.isSubscriber ? \"Active\" : \"Inactive\"}</td>\r\n                    <td>{users.subscription_id}</td>\r\n                    <td>\r\n                      <div class=\"d-flex justify-content-center align-items-center\">\r\n                        <div class=\"d-grid gap-1\">\r\n                          <CancelSubscriptionAdmin\r\n                            subscriptionId={users.subscription_id}\r\n                            accessToken={accessToken}\r\n                            id={users._id}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })}\r\n          </tbody>\r\n        )}\r\n      </Table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserListScreen;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}